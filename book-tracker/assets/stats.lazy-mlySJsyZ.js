import{a as g,f as p,u as m,j as e,c as j,r as h}from"./index-BLvFO9aW.js";async function f(a){return(await g.get("/stats/reading-graph",{params:{start:a.start,end:a.end},headers:{Authorization:`Bearer ${p()}`}})).data}const y={getReadingGraph:f},b=()=>a=>m({queryKey:["stats-reading-graph"],queryFn:()=>y.getReadingGraph(a)});function D({start:a,end:r}){const s=b()({start:a,end:r}),u=new Date(a),d=new Date(r),c={},i={Sun:[],Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[]};if(s.data&&!s.isFetching&&!s.isLoading){for(let t=u;t<=d;t.setDate(t.getDate()+1)){const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()],l=t.toISOString().split("T")[0],x=s.data.days[l];i[n].push({date:l,intensity:x?1:0,pages:x||0})}for(let t=0;t<i.Sun.length;t++){const n=new Date(i.Sun[t].date),x=`${n.toLocaleString("default",{month:"short"})}-${n.getFullYear()}`;c[x]=c[x]?c[x]+1:1}}else return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:"Reading Graph"}),e.jsx("div",{children:"Loading..."})]});return e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold",children:["Reading Graph ",s.data.total?`- ${s.data.total} pages`:""]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-fixed",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("td",{}),Object.keys(c).map(t=>e.jsx("td",{className:"text-sm",colSpan:c[t],children:t.split("-")[0]},t))]})}),e.jsx("tbody",{children:Object.keys(i).map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm min-h-6 h-6 pr-1",children:t}),i[t].map((n,l)=>e.jsxs(e.Fragment,{children:[l==0&&S(n.date,t,i)?e.jsx("td",{}):null,e.jsx("td",{className:`min-w-6 w-6 p-0 border ${N(n.intensity)}`,title:n.date})]},l))]},t))})]})})]})}function S(a,r,o){const s=new Date(a),u=Object.keys(o).indexOf(r);for(let d=u;d<Object.keys(o).length;d++){const c=new Date(o[Object.keys(o)[d]][0].date);if(s.getTime()>c.getTime())return!0}return!1}function N(a){return a===1?"bg-cyan-100":a===2?"bg-cyan-200":a===3?"bg-cyan-300":a===4?"bg-cyan-400":a===5?"bg-cyan-500":""}const R=j("/stats")({component:w});function w(){const a=new Date().getFullYear(),[r,o]=h.useState(new Date(a,0,1).toISOString().split("T")[0]),[s,u]=h.useState(new Date(a,11,31).toISOString().split("T")[0]),[d,c]=h.useState({start:r,end:s});return e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl text-center",children:"Your Statistics"}),e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:r,onChange:n=>o(n.target.value),className:"w-full text-xs border-2 rounded-md py-1 px-2 focus:border-gray-200 h-[34px]"}),e.jsx("div",{className:"text-gray-400 text-sm",children:"â†’"}),e.jsx("input",{type:"date",value:s,onChange:n=>u(n.target.value),className:"w-full text-xs border-2 rounded-md py-1 px-2 focus:border-gray-200 h-[34px]"}),e.jsx("button",{onClick:()=>c({start:r,end:s}),className:"w-full text-xs border-2 rounded-md py-1 px-2 bg-white hover:bg-gray-200 transition duration-250 h-[34px]",children:"Update"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex text-center items-center gap-2",children:[e.jsxs("p",{className:"w-full",children:["Books ",e.jsx("strong",{children:10})]}),e.jsxs("p",{className:"w-full",children:["Pages ",e.jsx("strong",{children:3600})]})]}),e.jsx("p",{className:"text-sm text-center",children:e.jsx("i",{children:"page count may be inaccurate due to book data quality"})})]})]}),e.jsx("br",{}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(D,{start:d.start,end:d.end})})]})}export{R as Route};
